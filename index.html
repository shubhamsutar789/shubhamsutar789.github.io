<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Project Spark | Custom Engineering Projects</title>

    <!-- Tailwind & Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
    <script src="https://unpkg.com/feather-icons"></script>

    <!-- Same styles as before -->
    <style>
        body{font-family:'Poppins',sans-serif}
        html{scroll-behavior:smooth}
        .hero-gradient{background:linear-gradient(135deg,#f5f7fa 0%,#c3cfe2 100%)}
        .btn-primary{@apply bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg shadow-lg hover:bg-blue-700 transform hover:-translate-y-0.5 transition-all duration-300}
        .btn-secondary{@apply bg-gray-200 text-gray-800 font-semibold py-3 px-8 rounded-lg shadow-lg hover:bg-gray-300 transform hover:-translate-y-0.5 transition-all duration-300}
        .section-title{@apply text-3xl md:text-4xl font-bold text-gray-800 text-center}
        .section-subtitle{@apply text-lg text-gray-500 text-center mt-2 mb-12 max-w-2xl mx-auto}
        .category-card{@apply bg-white p-6 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 ease-in-out cursor-pointer flex flex-col items-start text-left group}
        .modal-nav-btn{@apply flex items-center justify-center px-4 py-2 rounded-lg font-medium text-gray-700 bg-white border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 hover:text-blue-700 transition-all duration-200 shadow-sm}
        .modal-nav-btn.active{@apply bg-blue-600 text-white border-blue-600 shadow-md}
        .btn-admin{@apply flex items-center w-full text-left px-4 py-3 rounded-lg font-semibold text-gray-700 bg-white border border-gray-300 hover:bg-gray-100 hover:border-gray-400 transition-all duration-200 shadow-sm}
        .btn-danger{@apply flex items-center w-full text-left px-4 py-3 rounded-lg font-semibold text-red-700 bg-red-50 border border-red-300 hover:bg-red-100 hover:border-red-400 transition-all duration-200 shadow-sm}
    </style>
</head>
<body class="bg-gray-50">

<!-- ====== SAME MARKUP AS BEFORE ====== -->
<header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40">
    <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
        <div class="text-2xl font-bold text-gray-900">
            <a href="#">Project<span class="text-blue-600">Spark</span></a>
        </div>
        <div class="hidden md:flex items-center space-x-8">
            <a href="#features" class="text-gray-600 hover:text-blue-600 font-medium">Why Us</a>
            <a href="#projects" class="text-gray-600 hover:text-blue-600 font-medium">Projects</a>
            <a href="#contact" class="btn-primary px-6 py-2">Contact Me</a>
        </div>
        <div class="md:hidden">
            <a href="#contact" class="bg-blue-600 text-white font-semibold px-4 py-2 rounded-lg">Contact</a>
        </div>
    </nav>
</header>

<main>
    <!-- HERO -->
    <section class="hero-gradient">
        <div class="container mx-auto px-6 py-24 text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold text-gray-800 mb-4">Find Your Perfect Engineering Project</h1>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto mb-8">From simple mini-projects to advanced IoT systems, get the guidance and resources you need to build, learn, and succeed in your academics.</p>
            <a href="#projects" class="btn-primary">Explore Project Ideas</a>
        </div>
    </section>

    <!-- FEATURES -->
    <section id="features" class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="section-title">Why Build With Us?</h2>
            <p class="section-subtitle">We provide more than just a project; we provide a complete learning experience.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center p-6">
                    <div class="flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 text-blue-600 mx-auto mb-4"><i data-feather="book-open" class="w-8 h-8"></i></div>
                    <h3 class="text-xl font-semibold mb-2">Complete Documentation</h3>
                    <p class="text-gray-500">Receive detailed reports, circuit diagrams, and code explanations to understand every aspect of your project.</p>
                </div>
                <div class="text-center p-6">
                    <div class="flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 text-blue-600 mx-auto mb-4"><i data-feather="award" class="w-8 h-8"></i></div>
                    <h3 class="text-xl font-semibold mb-2">Quality Components</h3>
                    <p class="text-gray-500">We use reliable and high-quality components to ensure your project works flawlessly.</p>
                </div>
                <div class="text-center p-6">
                    <div class="flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 text-blue-600 mx-auto mb-4"><i data-feather="users" class="w-8 h-8"></i></div>
                    <h3 class="text-xl font-semibold mb-2">One-on-One Mentorship</h3>
                    <p class="text-gray-500">Get personalized guidance and support throughout your project-building journey.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- PROJECTS -->
    <section id="projects" class="py-20">
        <div class="container mx-auto px-6">
            <h2 class="section-title">Project Categories</h2>
            <p class="section-subtitle">Select a category to explore a curated list of project ideas suitable for all skill levels.</p>
            <div id="project-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"></div>
        </div>
    </section>

    <!-- HOW IT WORKS -->
    <section id="how-it-works" class="py-20 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="section-title">Get Your Project in 3 Simple Steps</h2>
            <p class="section-subtitle">A straightforward process from idea to implementation.</p>
            <div class="relative"><div class="hidden md:block absolute top-1/2 left-0 w-full border-t-2 border-dashed border-gray-300 -translate-y-1/2"></div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-16 relative">
                    <div class="text-center">
                        <div class="flex items-center justify-center h-20 w-20 rounded-full bg-white border-2 border-dashed border-gray-300 text-blue-600 mx-auto mb-4 text-3xl font-bold">1</div>
                        <h3 class="text-xl font-semibold mb-2">Browse & Select</h3>
                        <p class="text-gray-500">Explore our extensive list of projects and find the one that excites you the most.</p>
                    </div>
                    <div class="text-center">
                        <div class="flex items-center justify-center h-20 w-20 rounded-full bg-white border-2 border-dashed border-gray-300 text-blue-600 mx-auto mb-4 text-3xl font-bold">2</div>
                        <h3 class="text-xl font-semibold mb-2">Get In Touch</h3>
                        <p class="text-gray-500">Contact us with your chosen project idea or a custom requirement for a detailed discussion.</p>
                    </div>
                    <div class="text-center">
                        <div class="flex items-center justify-center h-20 w-20 rounded-full bg-white border-2 border-dashed border-gray-300 text-blue-600 mx-auto mb-4 text-3xl font-bold">3</div>
                        <h3 class="text-xl font-semibold mb-2">Build & Learn</h3>
                        <p class="text-gray-500">Receive your project kit, documentation, and expert guidance to start building and learning.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="py-20 hero-gradient">
        <div class="container mx-auto px-6 text-center">
            <h2 class="section-title">Have a Project in Mind?</h2>
            <p class="section-subtitle">Let's turn your idea into reality. Reach out today for a free consultation.</p>
            <div class="max-w-4xl mx-auto bg-white/50 p-8 rounded-xl shadow-lg">
                <div class="flex flex-col md:flex-row justify-around items-center space-y-8 md:space-y-0">
                    <div class="flex items-center space-x-4"><i data-feather="user" class="w-8 h-8 text-blue-600"></i><div><h4 class="font-semibold text-lg">Shubham Sutar</h4><p class="text-gray-600">Project Mentor</p></div></div>
                    <div class="flex items-center space-x-4"><i data-feather="mail" class="w-8 h-8 text-blue-600"></i><div><h4 class="font-semibold text-lg">Email</h4><a href="mailto:Shubhamsutar789@gmail.com" class="text-blue-600 hover:underline">Shubhamsutar789@gmail.com</a></div></div>
                    <div class="flex items-center space-x-4"><i data-feather="phone" class="w-8 h-8 text-blue-600"></i><div><h4 class="font-semibold text-lg">Phone / WhatsApp</h4><p class="text-gray-600">+91 7410555337</p></div></div>
                </div>
            </div>
        </div>
    </section>
</main>

<footer class="bg-gray-800 text-white">
    <div class="container mx-auto px-6 py-6 text-center relative">
        <p>&copy; 2024 ProjectSpark. All Rights Reserved. Designed to help students innovate.</p>
        <button id="admin-login-btn" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white"><i data-feather="lock" class="w-5 h-5"></i></button>
    </div>
</footer>

<!-- ====== MODALS (unchanged) ====== -->
<div id="projects-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-5xl max-h-full overflow-y-auto">
        <div class="flex justify-between items-center p-5 border-b"><h3 class="text-2xl font-semibold">Mini Project Ideas</h3><button class="text-gray-400 hover:text-gray-800 text-4xl close-modal-btn">&times;</button></div>
        <div class="p-6"><ol class="list-decimal list-inside grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-x-8 gap-y-3 text-gray-700" id="mini-projects-list"></ol></div>
    </div>
</div>

<div id="categorized-projects-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-full overflow-y-auto">
        <div class="flex justify-between items-center p-5 border-b"><h3 id="categorized-modal-title" class="text-2xl font-semibold">Project Ideas</h3><button class="text-gray-400 hover:text-gray-800 text-4xl close-modal-btn">&times;</button></div>
        <div class="p-6" id="categorized-project-content"></div>
    </div>
</div>

<!-- Admin Login -->
<div id="login-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-sm">
        <div class="flex justify-between items-center p-5 border-b"><h3 class="text-2xl font-semibold">Admin Panel</h3><button class="text-gray-400 hover:text-gray-800 text-4xl close-modal-btn">&times;</button></div>
        <div id="login-view" class="p-6">
            <form id="login-form">
                <div class="mb-4"><label for="password" class="block text-gray-700 font-medium mb-2">Password</label><input type="password" id="password" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"/><p id="login-error" class="text-red-500 text-sm mt-1 hidden">Incorrect password.</p></div>
                <button type="submit" class="w-full btn-primary">Login</button>
            </form>
        </div>
        <div id="admin-options-view" class="p-6 hidden">
            <div class="flex flex-col space-y-3">
                <button id="open-add-project-btn" class="btn-admin"><i data-feather="plus-circle" class="w-5 h-5 mr-3"></i>Add New Project</button>
                <button id="open-manage-projects-btn" class="btn-admin"><i data-feather="edit" class="w-5 h-5 mr-3"></i>Manage Projects</button>
                <button id="open-manage-categories-btn" class="btn-admin"><i data-feather="tag" class="w-5 h-5 mr-3"></i>Manage Categories</button>
                <button id="open-manage-boards-btn" class="btn-admin"><i data-feather="server" class="w-5 h-5 mr-3"></i>Manage Boards</button>
                <button id="reset-database-btn" class="btn-danger mt-4"><i data-feather="trash-2" class="w-5 h-5 mr-3"></i>Reset Database</button>
            </div>
        </div>
    </div>
</div>

<!-- Add / Edit Project -->
<div id="add-edit-project-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[60] hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-lg">
        <div class="flex justify-between items-center p-5 border-b"><h3 id="add-edit-modal-title" class="text-2xl font-semibold">Add New Project</h3><button class="text-gray-400 hover:text-gray-800 text-4xl close-modal-btn">&times;</button></div>
        <div class="p-6">
            <form id="add-edit-project-form">
                <input type="hidden" id="project-id"/>
                <div class="space-y-4">
                    <div><label for="project-title" class="block text-gray-700 font-medium mb-2">Project Title</label><input type="text" id="project-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required/></div>
                    <div><label for="project-board" class="block text-gray-700 font-medium mb-2">Board</label><select id="project-board" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></select></div>
                    <div><label for="project-category" class="block text-gray-700 font-medium mb-2">Category</label><select id="project-category" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required></select></div>
                </div>
                <button type="submit" id="save-project-btn" class="w-full btn-primary mt-6">Save Project</button>
            </form>
        </div>
    </div>
</div>

<!-- Manage Projects -->
<div id="manage-projects-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-6xl max-h-full flex flex-col">
        <div class="flex justify-between items-center p-5 border-b"><h3 class="text-2xl font-semibold">Project Management</h3><button class="text-gray-400 hover:text-gray-800 text-4xl close-modal-btn">&times;</button></div>
        <div class="p-6 overflow-y-auto" id="management-content"></div>
    </div>
</div>

<!-- Manage Categories -->
<div id="manage-categories-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[60] hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-4xl max-h-full flex flex-col">
        <div class="flex justify-between items-center p-5 border-b"><h3 class="text-2xl font-semibold">Category Management</h3><button class="text-gray-400 hover:text-gray-800 text-4xl close-modal-btn">&times;</button></div>
        <div class="p-6 overflow-y-auto" id="category-management-content"></div>
    </div>
</div>

<!-- Manage Boards -->
<div id="manage-boards-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[60] hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-3xl max-h-full flex flex-col">
        <div class="flex justify-between items-center p-5 border-b"><h3 class="text-2xl font-semibold">Board Management</h3><button class="text-gray-400 hover:text-gray-800 text-4xl close-modal-btn">&times;</button></div>
        <div class="p-6 overflow-y-auto" id="board-management-content"></div>
    </div>
</div>

<!-- Delete Confirmation -->
<div id="delete-confirm-modal" class="fixed inset-0 bg-black bg-opacity-60 z-[70] hidden items-center justify-center p-4 modal">
    <div class="bg-white rounded-lg shadow-2xl w-full max-w-md">
        <div class="p-6 text-center"><i data-feather="alert-triangle" class="w-16 h-16 text-red-500 mx-auto mb-4"></i><h3 class="text-2xl font-semibold mb-2">Are you sure?</h3><p class="text-gray-500 mb-6" id="delete-confirm-text"></p>
            <div class="flex justify-center space-x-4"><button id="cancel-delete-btn" class="btn-secondary px-8">Cancel</button><button id="confirm-delete-btn" class="bg-red-600 text-white font-semibold py-3 px-8 rounded-lg shadow-lg hover:bg-red-700">Delete</button></div>
        </div>
    </div>
</div>

<!-- ====== FIREBASE SCRIPT (unchanged except two small additions) ====== -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, deleteDoc, getDocs, writeBatch, arrayUnion, arrayRemove, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBLASOGSVG3QvAr8R4mhDlJH1iPsE6ojnE",
        authDomain: "projectspark-website.firebaseapp.com",
        projectId: "projectspark-website",
        storageBucket: "projectspark-website.appspot.com",
        messagingSenderId: "114149323229",
        appId: "1:114149323229:web:186ffc8cd472ca9c3e8634",
        measurementId: "G-J4YJXBWC06"
    };
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

    const app   = initializeApp(firebaseConfig);
    const auth  = getAuth(app);
    const db    = getFirestore(app);

    let allProjects = {}, firestoreProjects = [], allCategories = {}, allBoards = [];

    /* ----------  SAME BASE DATA AS BEFORE  ---------- */
    const baseData = {
        boards: [
            { id: 'mini', name: 'Mini Projects', shortName: 'Mini', description: 'Perfect for beginners...', color: 'E9F2FF/3B82F6', icon: 'cpu' },
            { id: 'arduino', name: 'Arduino', shortName: 'Arduino', description: 'Versatile projects...', color: 'E0F2F1/0D9488', icon: 'radio' },
            { id: 'esp', name: 'ESP32 / ESP8266', shortName: 'ESP32', description: 'Advanced IoT...', color: 'ECFDF5/10B981', icon: 'wifi' },
            { id: 'rpi', name: 'Raspberry Pi', shortName: 'RPi', description: 'Powerful projects...', color: 'FEF2F2/DC2626', icon: 'server' }
        ],
        categories: {
            arduino: [
                { name: "Sensor Based", icon: "activity" },
                { name: "Bluetooth (HC-05)", icon: "bluetooth" },
                { name: "GSM & GPS", icon: "radio" },
                { name: "Wireless (RF/nRF/LoRa)", icon: "wifi-off" },
                { name: "Robotics & Automation", icon: "cpu" },
                { name: "Displays & Interfaces", icon: "monitor" }
            ],
            esp: [
                { name: "WiFi & IoT", icon: "wifi" },
                { name: "Bluetooth & BLE", icon: "bluetooth" },
                { name: "ESP-NOW & LoRa", icon: "zap" },
                { name: "Camera (ESP32-CAM)", icon: "camera" },
                { name: "Automation & Control", icon: "sliders" }
            ],
            rpi: [
                { name: "Computer Vision & AI", icon: "eye" },
                { name: "Automation & Robotics", icon: "cpu" },
                { name: "Networking & Security", icon: "shield" }
            ]
        },
        projects: {
            mini: ["LED Chaser/Sequencer","Rain Alarm","Fire Alarm (Thermistor)",...],
            arduino: { "Sensor Based": ["Weather Station...","Heart Rate..."], ... },
            esp:    { "WiFi & IoT": ["IoT Weather Station...","Centralized Web..."], ... },
            rpi:    { "Computer Vision & AI": ["Object Detection...","Face Recognition..."], ... }
        }
    };

    /* ----------  EXACT SAME HELPERS AS BEFORE  ---------- */
    function populateList(containerId, data){...}
    function populateCategorizedListWithButtons(...){...}
    function renderAllLists(){...}
    function renderProjectCategoryCards(){...}
    function openModal(id){...}
    function closeModal(modal){...}
    async function seedDatabase(){...}
    async function resetDatabase(){...}

    /* ----------  ADMIN PANEL LOGIC  ---------- */
    const loginForm = document.getElementById('login-form');
    const passwordInput = document.getElementById('password');
    const loginError = document.getElementById('login-error');
    const addEditProjectForm = document.getElementById('add-edit-project-form');
    const projectBoardSelect = document.getElementById('project-board');
    const projectCategorySelect = document.getElementById('project-category');
    const projectIdInput = document.getElementById('project-id');
    const addEditModalTitle = document.getElementById('add-edit-modal-title');

    function updateBoardDropdowns(){
        projectBoardSelect.innerHTML='';
        allBoards.forEach(b=>projectBoardSelect.add(new Option(b.name,b.id)));
    }
    function updateCategoryDropdown(){
        const board = projectBoardSelect.value;
        projectCategorySelect.innerHTML='';
        if(board==='mini'){
            projectCategorySelect.disabled=true;
            projectCategorySelect.add(new Option("N/A for Mini Projects",""));
        }else{
            projectCategorySelect.disabled=false;
            (allCategories[board]||[]).forEach(c=>projectCategorySelect.add(new Option(c.name,c.name)));
        }
    }

    /* ----------  ADMIN EVENT LISTENERS  ---------- */
    document.getElementById('open-add-project-btn').addEventListener('click',()=>{
        addEditProjectForm.reset();
        projectIdInput.value='';
        addEditModalTitle.textContent='Add New Project';
        updateBoardDropdowns();
        updateCategoryDropdown();
        projectBoardSelect.addEventListener('change',updateCategoryDropdown); // <-- FIX 1
        openModal('add-edit-project-modal');
    });

    document.getElementById('management-content').addEventListener('click',e=>{
        const editBtn=e.target.closest('.edit-btn');
        if(editBtn){
            const id=editBtn.dataset.id;
            const p=firestoreProjects.find(p=>p.id===id);
            if(p){
                addEditProjectForm.reset();
                projectIdInput.value=id;
                document.getElementById('project-title').value=p.title;
                updateBoardDropdowns();
                projectBoardSelect.value=p.board;
                updateCategoryDropdown();
                projectBoardSelect.addEventListener('change',updateCategoryDropdown); // <-- FIX 2
                openModal('add-edit-project-modal');
            }
        }
    });

    /* ----------  SAME FIREBASE LISTENERS + INIT  ---------- */
    async function main(){
        feather.replace();
        /* -- your existing listeners & snapshots -- */
        try{
            await signInAnonymously(auth);
            console.log("Authenticated UID:",auth.currentUser.uid);

            const projectsCol=collection(db,"artifacts",appId,"public","data","projects");
            const categoriesCol=collection(db,"artifacts",appId,"public","data","categories");
            const boardsCol   =collection(db,"artifacts",appId,"public","data","boards");

            onSnapshot(boardsCol,async snap=>{
                if(snap.empty){await seedDatabase();}
                else{allBoards=snap.docs.map(d=>d.data()); renderProjectCategoryCards(); updateBoardDropdowns();}
            });

            onSnapshot(categoriesCol,snap=>{
                allCategories={}; snap.docs.forEach(d=>allCategories[d.id]=d.data().list);
                updateCategoryDropdown();
            });

            onSnapshot(projectsCol,snap=>{
                firestoreProjects=snap.docs.map(d=>({id:d.id,...d.data()}));
                /* rebuild allProjects... */
                allProjects={}; allBoards.forEach(b=>allProjects[b.id]=b.id==='mini'?[]:{});
                firestoreProjects.forEach(p=>{
                    if(p.board==='mini') allProjects.mini.push(p.title);
                    else{
                        if(!allProjects[p.board][p.category]) allProjects[p.board][p.category]=[];
                        allProjects[p.board][p.category].push(p.title);
                    }
                });
                renderAllLists();
                populateManagementConsole();
            });

        }catch(err){console.error("Firebase init failed",err);}
    }
    main();
</script>
</body>
</html>
